# å…¬ä¼—å·æ–‡ç« çˆ¬è™«ç®¡ç†å¹³å°

ä¸€ä¸ªåŸºäºAIçš„å…¬ä¼—å·æ–‡ç« å†…å®¹æå–å’Œç®¡ç†å¹³å°,æ”¯æŒè‡ªå®šä¹‰ç»´åº¦æå–,å›¾ç‰‡è¯†åˆ«å­—æ®µå®šä¹‰ã€‚

## åŠŸèƒ½ç‰¹æ€§

âœ¨ **æ ¸å¿ƒåŠŸèƒ½**
- å…¬ä¼—å·ç®¡ç† - ç®¡ç†å¤šä¸ªå…¬ä¼—å·
- æ–‡ç« çˆ¬å– - è‡ªåŠ¨æŠ“å–å…¬ä¼—å·æ–‡ç« å†…å®¹
- ç»´åº¦å®šä¹‰ - è‡ªå®šä¹‰æå–å­—æ®µ,æ”¯æŒå›¾ç‰‡è¯†åˆ«
- AIæå– - ä½¿ç”¨Claude AIè‡ªåŠ¨æå–ç»“æ„åŒ–æ•°æ®
- æ•°æ®å¯¼å‡º - å¯¼å‡ºæå–ç»“æœä¸ºJSON

ğŸ¯ **ç‰¹è‰²åŠŸèƒ½**
- å›¾ç‰‡è¯†åˆ«ç»´åº¦ - ä¸Šä¼ Excelæˆªå›¾è‡ªåŠ¨è¯†åˆ«è¡¨å¤´
- ç»´åº¦é”å®šæœºåˆ¶ - ç¡®è®¤ååªèƒ½æ–°å¢,ä¸èƒ½ä¿®æ”¹
- å¤šæ¨¡å‹æ”¯æŒ - Haiku(å¿«é€Ÿ)å’ŒSonnet(ç²¾å‡†)
- æ‰¹é‡å¤„ç† - æ‰¹é‡æ·»åŠ æ–‡ç« ,æ‰¹é‡æå–

## æŠ€æœ¯æ ˆ

### åç«¯
- NestJS 10
- PostgreSQL 14+
- Prisma ORM
- JWTè®¤è¯
- Claude AI (Haiku 4.5 & Sonnet 4.5)
- Swagger APIæ–‡æ¡£

### å‰ç«¯
- Next.js 14
- React 18
- Ant Design / shadcn/ui
- TypeScript
- ZustandçŠ¶æ€ç®¡ç†

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Node.js 18+
- PostgreSQL 14+
- npmæˆ–pnpm

### 1. å…‹éš†é¡¹ç›®

```bash
cd wchat_spark
```

### 2. å¯åŠ¨æ•°æ®åº“

ä½¿ç”¨Dockerå¿«é€Ÿå¯åŠ¨PostgreSQL:

```bash
docker run --name wchat-postgres \
  -e POSTGRES_USER=wchat \
  -e POSTGRES_PASSWORD=wchat123 \
  -e POSTGRES_DB=wchat_spider \
  -p 5432:5432 \
  -d postgres:14
```

### 3. å¯åŠ¨åç«¯

```bash
cd backend

# å®‰è£…ä¾èµ–
npm install

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘.env,è®¾ç½®æ•°æ®åº“è¿æ¥ç­‰

# åˆå§‹åŒ–æ•°æ®åº“
npm run prisma:generate
npm run prisma:migrate

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run start:dev
```

åç«¯å°†è¿è¡Œåœ¨ `http://localhost:4001`
APIæ–‡æ¡£: `http://localhost:4001/api`

### 4. å¯åŠ¨å‰ç«¯

```bash
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

å‰ç«¯å°†è¿è¡Œåœ¨ `http://localhost:4000`

## ä½¿ç”¨æµç¨‹

### 1. æ³¨å†Œç™»å½•
è®¿é—® `http://localhost:4000` æ³¨å†Œè´¦å·å¹¶ç™»å½•

### 2. åˆ›å»ºå…¬ä¼—å·
åœ¨å…¬ä¼—å·ç®¡ç†é¡µé¢æ·»åŠ è¦ç›‘æ§çš„å…¬ä¼—å·

### 3. å®šä¹‰æå–ç»´åº¦

**æ–¹å¼1: æ‰‹åŠ¨åˆ›å»º**
- æ·»åŠ ç»´åº¦æ¨¡æ¿
- å®šä¹‰éœ€è¦æå–çš„å­—æ®µ(åç§°ã€ç±»å‹ã€æè¿°ç­‰)
- ç¡®è®¤å¹¶é”å®š

**æ–¹å¼2: å›¾ç‰‡è¯†åˆ«**
- ä¸Šä¼ Excelè¡¨æ ¼æˆªå›¾
- AIè‡ªåŠ¨è¯†åˆ«è¡¨å¤´ç”Ÿæˆå­—æ®µ
- ç¼–è¾‘ç¡®è®¤å¹¶é”å®š

### 4. æ·»åŠ æ–‡ç« 
- æ‰‹åŠ¨è¾“å…¥å…¬ä¼—å·æ–‡ç« é“¾æ¥
- æˆ–æ‰¹é‡å¯¼å…¥å¤šä¸ªé“¾æ¥
- ç³»ç»Ÿè‡ªåŠ¨çˆ¬å–æ–‡ç« å†…å®¹

### 5. æå–æ•°æ®
- é€‰æ‹©æ–‡ç« ,ç‚¹å‡»"æå–æ‰€æœ‰ç»´åº¦"
- AIè‡ªåŠ¨æ ¹æ®ç»´åº¦å®šä¹‰æå–æ•°æ®
- æŸ¥çœ‹å’Œå¯¼å‡ºæå–ç»“æœ

## é¡¹ç›®ç»“æ„

```
wchat_spark/
â”œâ”€â”€ backend/              # NestJSåç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ auth/        # è®¤è¯
â”‚   â”‚   â”œâ”€â”€ users/       # ç”¨æˆ·
â”‚   â”‚   â”œâ”€â”€ accounts/    # å…¬ä¼—å·
â”‚   â”‚   â”œâ”€â”€ articles/    # æ–‡ç« 
â”‚   â”‚   â”œâ”€â”€ dimensions/  # ç»´åº¦
â”‚   â”‚   â”œâ”€â”€ extractions/ # æå–
â”‚   â”‚   â”œâ”€â”€ claude/      # Claude AI
â”‚   â”‚   â””â”€â”€ spider/      # çˆ¬è™«
â”‚   â””â”€â”€ prisma/          # æ•°æ®åº“Schema
â”‚
â”œâ”€â”€ frontend/            # Next.jså‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/        # é¡µé¢
â”‚   â”‚   â”œâ”€â”€ components/ # ç»„ä»¶
â”‚   â”‚   â””â”€â”€ lib/        # å·¥å…·
â”‚
â””â”€â”€ DATABASE_DESIGN.md  # æ•°æ®åº“è®¾è®¡æ–‡æ¡£
```

## æ•°æ®åº“è®¾è®¡

è¯¦è§ [DATABASE_DESIGN.md](./DATABASE_DESIGN.md)

æ ¸å¿ƒè¡¨:
- `users` - ç”¨æˆ·è¡¨
- `official_accounts` - å…¬ä¼—å·è¡¨
- `articles` - æ–‡ç« è¡¨
- `dimension_templates` - ç»´åº¦æ¨¡æ¿è¡¨
- `extraction_results` - æå–ç»“æœè¡¨

## APIæ–‡æ¡£

å¯åŠ¨åç«¯åè®¿é—®: `http://localhost:4001/api`

ä¸»è¦ç«¯ç‚¹:
- `/auth` - è®¤è¯ç›¸å…³
- `/accounts` - å…¬ä¼—å·ç®¡ç†
- `/articles` - æ–‡ç« ç®¡ç†
- `/dimensions` - ç»´åº¦ç®¡ç†
- `/extractions` - å†…å®¹æå–

## ç¯å¢ƒå˜é‡

### åç«¯ (.env)

è¯·å‚è€ƒ `backend/.env.example` æ–‡ä»¶é…ç½®ç¯å¢ƒå˜é‡:

```bash
cp backend/.env.example backend/.env
# ç„¶åç¼–è¾‘ backend/.env å¡«å…¥çœŸå®é…ç½®
```

ä¸»è¦é…ç½®é¡¹:
- `DATABASE_URL` - PostgreSQL æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
- `JWT_SECRET` - JWT åŠ å¯†å¯†é’¥(è¯·ä½¿ç”¨å¼ºå¯†ç )
- `ANTHROPIC_API_KEY` - Claude API å¯†é’¥
- `SPIDER_API_URL` - Spider æœåŠ¡åœ°å€
- `PORT` - åç«¯æœåŠ¡ç«¯å£(é»˜è®¤ 4001)
- `CORS_ORIGIN` - å…è®¸çš„è·¨åŸŸæ¥æº

### å‰ç«¯

å‰ç«¯é€šè¿‡ Next.js API ä»£ç†è½¬å‘è¯·æ±‚,æ— éœ€é¢å¤–é…ç½®ã€‚

å¦‚éœ€ä¿®æ”¹åç«¯åœ°å€,å¯åœ¨ `frontend/.env` ä¸­é…ç½®:
```env
BACKEND_URL=http://your-backend-url:4001
```

## å¼€å‘

### åç«¯å¼€å‘
```bash
cd backend
npm run start:dev      # å¼€å‘æ¨¡å¼
npm run build          # æ„å»º
npm run test           # æµ‹è¯•
npm run prisma:studio  # æ•°æ®åº“å¯è§†åŒ–
```

### å‰ç«¯å¼€å‘
```bash
cd frontend
npm run dev     # å¼€å‘æ¨¡å¼
npm run build   # æ„å»º
npm run lint    # ä»£ç æ£€æŸ¥
```

## éƒ¨ç½²

### åç«¯éƒ¨ç½²
1. æ„å»ºé¡¹ç›®: `npm run build`
2. è®¾ç½®ç¯å¢ƒå˜é‡
3. è¿è¡Œè¿ç§»: `npm run prisma:migrate`
4. å¯åŠ¨: `npm run start:prod`

### å‰ç«¯éƒ¨ç½²
1. æ„å»ºé¡¹ç›®: `npm run build`
2. ä½¿ç”¨Next.jsæœåŠ¡å™¨æˆ–å¯¼å‡ºé™æ€æ–‡ä»¶

æ¨èéƒ¨ç½²å¹³å°:
- åç«¯: Railway, Render, Fly.io
- å‰ç«¯: Vercel, Netlify
- æ•°æ®åº“: Supabase, Neon

## å¸¸è§é—®é¢˜

**Q: Claude APIè°ƒç”¨å¤±è´¥?**
A: æ£€æŸ¥`ANTHROPIC_BASE_URL`å’Œ`ANTHROPIC_AUTH_TOKEN`é…ç½®

**Q: æ–‡ç« çˆ¬å–å¤±è´¥?**
A: ç¡®ä¿Spider APIåœ°å€æ­£ç¡®,ç½‘ç»œå¯è®¿é—®

**Q: ç»´åº¦å·²é”å®šæ— æ³•ä¿®æ”¹?**
A: è¿™æ˜¯è®¾è®¡ç‰¹æ€§,åªèƒ½é€šè¿‡"æ·»åŠ å­—æ®µ"åŠŸèƒ½æ–°å¢

**Q: æå–ç»“æœä¸å‡†ç¡®?**
A: å°è¯•åˆ‡æ¢åˆ°Sonnetæ¨¡å‹,æˆ–ä¼˜åŒ–å­—æ®µæè¿°

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Request!

## License

MIT

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜,è¯·æäº¤Issueæˆ–è”ç³»å¼€å‘è€…ã€‚
